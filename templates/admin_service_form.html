{% extends "base.html" %}
{% block content %}
<h1>{{ 'Add Service' if mode=='new' else 'Edit Service' }}</h1>
<form method="post" class="form">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  <label>Title
    <input name="title" value="{{ form.get('title', '') }}" required>
  </label>
  <label>Description
    <textarea name="description" rows="5">{{ form.get('description', '') }}</textarea>
  </label>
  <label>Price (optional)
    <input name="price" value="{{ form.get('price', '') }}" placeholder="$50/hr">
  </label>
  <label>Posted by (optional)
    <input name="posted_by" value="{{ form.get('posted_by', profile.first_name or '') }}" placeholder="e.g., Taime">
  </label>
  <label class="checkbox">
    <input type="checkbox" name="is_certified" {% if form.get('is_certified') == 1 %}checked{% endif %}>
    Certified Service
  </label>
  <div id="certification-proof" class="{% if not form.get('is_certified') %}hidden{% endif %}">
    <label>Certification Proof/Link
      <input name="certification_proof" value="{{ form.get('certification_proof', '') }}" placeholder="https://example.com/certificate or License #12345">
      <small>Provide a link to your certification or license number</small>
    </label>
  </div>
  <label class="checkbox">
    <input type="checkbox" name="active" {% if form.get('active', True) in (True, 'on', 'true', '1') %}checked{% endif %}>
    Active
  </label>
  <div class="form-actions">
    <a class="btn secondary" href="{{ url_for('admin_services') }}">Cancel</a>
    <button class="btn" type="submit">{{ 'Create' if mode=='new' else 'Save changes' }}</button>
  </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const certifiedCheckbox = document.querySelector('input[name="is_certified"]');
    const certificationProof = document.getElementById('certification-proof');
    
    if (certifiedCheckbox && certificationProof) {
        certifiedCheckbox.addEventListener('change', function() {
            if (this.checked) {
                certificationProof.style.display = 'block';
            } else {
                certificationProof.style.display = 'none';
                // Clear the proof field when unchecked
                const proofInput = certificationProof.querySelector('input[name="certification_proof"]');
                if (proofInput) proofInput.value = '';
            }
        });
    }
});
</script>
{% endblock %}
