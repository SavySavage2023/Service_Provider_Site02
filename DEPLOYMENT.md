# Render Deployment Guide

## Prerequisites
- GitHub account with this repository pushed
- Render account (free tier works): https://dashboard.render.com

## Step-by-Step Deployment

### 1. Push to GitHub
```bash
git push origin main
```

### 2. Connect Repository to Render

1. Go to https://dashboard.render.com
2. Click **"New +"** → **"Blueprint"**
3. Connect your GitHub account if not already connected
4. Select this repository (`Websites` or your repo name)
5. Render will automatically detect the `render.yaml` file

### 3. Configure Environment Variables

Render will prompt you to set these required environment variables:

- **`ADMIN_PASSWORD`**: Admin panel password (e.g., `admin123`)
- **`PROVIDER_PASSWORD`**: Provider registration password (e.g., `provider123`)
- **`SECRET_KEY`**: Auto-generated by Render (leave as-is)
- **`DISABLE_AUTH`**: Leave as `0` (auth enabled)

### 4. Deploy

1. Click **"Apply"** to start deployment
2. Render will:
   - Install dependencies from `requirements.txt`
   - Create a persistent disk for the SQLite database
   - Start the app with Gunicorn
   - Provide a public URL (e.g., `https://your-app-name.onrender.com`)

### 5. Initial Setup

Once deployed, visit your app URL and:

1. Go to `/admin/login` and log in with your `ADMIN_PASSWORD`
2. Configure:
   - Allowed ZIP codes (`/admin/zips`)
   - Admin profile (`/admin/profile`)
   - Services and products if desired

### 6. Provider Registration

Providers can register at `/provider/register` using the `PROVIDER_PASSWORD`.

## What's Included

Your `render.yaml` configures:
- ✅ **Python environment** with Flask
- ✅ **Free tier** hosting
- ✅ **Gunicorn** production server (2 workers)
- ✅ **Persistent disk** (1GB) mounted at `/opt/render/project/src/instance` for SQLite database
- ✅ **Auto-generated SECRET_KEY** for session security
- ✅ **Environment variables** for passwords

## Persistent Data

The SQLite database (`instance/site.db`) is stored on a **persistent disk**. This means:
- Data survives app restarts
- Data persists across deployments
- Database is backed up by Render

## Troubleshooting

### Check Logs
Go to your Render dashboard → Select your service → Click **"Logs"** tab

### Database Not Persisting
Ensure the disk is mounted correctly in `render.yaml`:
```yaml
disk:
  name: data
  mountPath: /opt/render/project/src/instance
  sizeGB: 1
```

### App Won't Start
- Check logs for missing dependencies
- Verify environment variables are set
- Ensure `gunicorn` is in `requirements.txt`

### Upload Issues
File uploads go to `static/uploads/`. On Render's free tier, these are **ephemeral** (lost on restart). For production, consider:
- Upgrading to a paid plan with larger persistent disk
- Using cloud storage (AWS S3, Cloudinary, etc.)

## Updating Your App

1. Make changes locally
2. Commit and push:
   ```bash
   git add -A
   git commit -m "Update description"
   git push origin main
   ```
3. Render auto-deploys on push (if auto-deploy enabled)
4. Or manually deploy from the Render dashboard

## Cost

- **Free Tier**: 750 hours/month (enough for one always-on service)
- **Persistent Disk**: 1GB included free
- **Bandwidth**: 100GB/month free

Paid plans start at $7/month for always-on services.

## Security Notes

- Never commit `.env` files or passwords to Git
- Use strong passwords for `ADMIN_PASSWORD` and `PROVIDER_PASSWORD`
- `SECRET_KEY` should be long and random (Render auto-generates)
- Enable HTTPS (automatic on Render)

## Support

- Render Docs: https://render.com/docs
- Flask Docs: https://flask.palletsprojects.com/
- This repo's README: `README.md`
